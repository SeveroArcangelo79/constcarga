<!DOCTYPE html><html lang="es"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/><title>RC: Carga y Descarga de un Capacitor</title><script src="https://cdn.tailwindcss.com"></script><script src="https://cdn.plot.ly/plotly-2.27.0.min.js"></script><style>body{font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Helvetica,Arial,sans-serif;background-color:#fff;color:#1f1f1f}.rc-table th{background-color:#f3f3f3;border:1px solid #d7d7d7;padding:4px;font-weight:600;font-size:.85rem;text-align:center}.rc-table td{border:1px solid #d7d7d7;padding:2px}.rc-table input[type="text"],.rc-table input[type="number"],.rc-table select{width:100%;border:none;background:0 0;padding:2px 4px;font-size:.9rem;outline:0}.rc-table input:focus,.rc-table select:focus{background-color:#e6f7ff}.rc-table tr:nth-child(even){background-color:#f9f9f9}.rc-table tr.selected{background-color:#cce8ff}.col-activado{width:70px;text-align:center}.col-nombre{width:auto}.col-modo{width:95px}.col-c{width:65px}.col-r{width:65px}.col-vs{width:55px}.col-v0{width:55px}.col-color{width:95px}::-webkit-scrollbar{width:8px;height:8px}::-webkit-scrollbar-track{background:#f1f1f1}::-webkit-scrollbar-thumb{background:#c1c1c1;border-radius:4px}::-webkit-scrollbar-thumb:hover{background:#a8a8a8}</style></head><body class="h-screen flex flex-col overflow-hidden"><div class="flex flex-row h-full p-2 gap-2"><div class="flex flex-col gap-2" style="flex:5;min-width:520px"><h2 class="text-base font-semibold">Escenarios</h2><div class="flex-1 border border-gray-300 overflow-auto bg-white relative"><table class="w-full border-collapse rc-table" id="scenariosTable"><thead class="sticky top-0 z-10"><tr><th class="col-activado">Activado</th><th class="col-nombre">Nombre</th><th class="col-modo">Modo</th><th class="col-c">C (F)</th><th class="col-r">R (Ω)</th><th class="col-vs">Vs (V)</th><th class="col-v0">V0 (V)</th><th class="col-color">Color</th></tr></thead><tbody id="tableBody"></tbody></table></div><div class="flex flex-row gap-2 mt-1"><button id="btnAdd" class="px-3 py-1 bg-gray-100 hover:bg-gray-200 border border-gray-300 rounded text-sm text-gray-700">Agregar fila</button> <button id="btnDel" class="px-3 py-1 bg-gray-100 hover:bg-gray-200 border border-gray-300 rounded text-sm text-gray-700">Eliminar fila</button><div class="flex-grow"></div><button id="btnCsv" class="px-3 py-1 bg-gray-100 hover:bg-gray-200 border border-gray-300 rounded text-sm text-gray-700">Exportar CSV</button> <button id="btnPlt" class="px-3 py-1 bg-gray-100 hover:bg-gray-200 border border-gray-300 rounded text-sm text-gray-700">Graficar</button> <button onclick="window.close()" class="px-3 py-1 bg-gray-100 hover:bg-gray-200 border border-gray-300 rounded text-sm text-gray-700">Salir</button></div></div><div class="flex flex-col gap-2" style="flex:5"><h2 class="text-base font-semibold">Gráfico Interactivo (Dominio del Tiempo)</h2><div id="plotDiv" class="flex-1 border border-gray-300 bg-white"></div><div id="cursorLabel" class="text-sm font-bold text-gray-700 h-6">Cursor: (mueva el mouse sobre el gráfico)</div></div><div class="flex flex-col gap-4 p-2 bg-gray-50 border-l border-gray-200" style="flex:2;min-width:250px"><h2 class="text-base font-semibold">Opciones</h2><div class="flex flex-col gap-3 text-sm"><div class="flex flex-col gap-1"><label class="font-medium">Duración Total</label><div class="flex flex-row gap-1"><input type="number" id="spinTmax" value="0.5" step="0.1" min="0.000001" class="flex-1 border border-gray-300 px-2 py-1 rounded focus:border-blue-500 outline-none"> <select id="comboTimeUnit" class="border border-gray-300 px-1 py-1 rounded bg-white w-16"><option value="S">S</option><option value="mS">mS</option></select></div></div><div class="flex flex-col gap-1"><label class="font-medium">Magnitud</label> <select id="comboY" class="w-full border border-gray-300 px-2 py-1 rounded bg-white"><option value="Vc">Tensión en el capacitor Vc (Volts)</option><option value="I">Corriente I (Amper)</option><option value="Q">Carga Q (Coulombs)</option></select></div><div class="flex flex-col gap-2 mt-1"><label class="flex items-center gap-2 cursor-pointer"><input type="checkbox" id="chkMarkTau" checked class="accent-blue-500"> <span>Marcar τ=R·C</span></label> <label class="flex items-center gap-2 cursor-pointer"><input type="checkbox" id="chkAutorange" checked class="accent-blue-500"> <span>Autoajustar ejes</span></label></div><div class="mt-4 p-3 rounded text-sm" style="background-color:#efe7df;color:#1f1f1f;height:220px;overflow-y:auto"><p class="font-semibold mb-1">Notas didácticas:</p><ul class="list-disc list-inside space-y-1"><li>Selecciona unidad (S o mS) arriba.</li><li>Carga: Vc sube hasta Vs.</li><li>Descarga: Vc baja desde V0 hasta 0.</li><li>τ (tau) = R·C determina la velocidad.</li><li>Puntos de simulación fijos en 2000.</li></ul></div></div></div></div><script>
(()=>{const d=document,M=Math,DP=2e3,CL={Celeste:"#12a4d9",Verde:"#12b886",Rojo:"#d91212",Naranja:"#ff9f1c",Violeta:"#9b5de5",Marrón:"#8b5e34","Gris Oscuro":"#555555",Negro:"#000000","Azul Oscuro":"#003366"};class _M{static c(t,m,c,r,v,o){const A=[],B=[],D=[];let z=null,y=c;if(null===r||0===r){for(let x of t){let w="CARGA"===m?(x>=0?v:0):(x>=0?0:o);A.push(w),B.push(null),D.push(y*w)}return{Vc:A,I:B,Q:D,tau:null}}r=parseFloat(r),z=r*y;for(let x of t){let w=0,u=0;"CARGA"===m?(w=v*(1-M.exp(-x/z)),u=(v-w)/r):(w=o*M.exp(-x/z),u=-w/r);A.push(w),B.push(u),D.push(y*w)}return{Vc:A,I:B,Q:D,tau:z}}}let RD=[],SI=-1,LT="S",TM=null;const g=e=>d.getElementById(e),ce=e=>d.createElement(e),ls=(a,b,n)=>{const r=[],s=(b-a)/(n-1);for(let i=0;i<n;i++)r.push(a+s*i);return r},fe=v=>0===v?"0":null===v||void 0===v?"":parseFloat(v.toPrecision(6)).toString(),cp=(v,f)=>{let x=parseFloat(v);return!isNaN(x)&&x>0?x:parseFloat(f)},sch=()=>{TM&&clearTimeout(TM),TM=setTimeout(rp,150)},ut=u=>{const s=g("spinTmax");let v=parseFloat(s.value);LT!==u&&(s.value="mS"===u?(1e3*v).toFixed(3):"S"===u?(v/1e3).toFixed(6):s.value,s.value=parseFloat(s.value).toString(),LT=u)};function ren(){const b=g("tableBody");b.innerHTML="",RD.forEach((r,i)=>{const x=ce("tr");i===SI&&x.classList.add("selected"),x.onclick=()=>{SI=i,ren()};const t1=ce("td");t1.className="col-activado";const c1=ce("input");c1.type="checkbox",c1.checked=r.a,c1.className="accent-blue-500",c1.onchange=e=>{r.a=e.target.checked,sch()},t1.appendChild(c1),x.appendChild(t1);const t2=ce("td");t2.className="col-nombre";const c2=ce("input");c2.type="text",c2.value=r.n,c2.onchange=e=>{r.n=e.target.value,sch()},t2.appendChild(c2),x.appendChild(t2);const t3=ce("td");t3.className="col-modo";const s3=ce("select");["CARGA","DESCARGA"].forEach(o=>{const q=ce("option");q.value=o,q.text=o,r.m===o&&(q.selected=!0),s3.appendChild(q)}),s3.onchange=e=>{r.m=e.target.value,sch()},t3.appendChild(s3),x.appendChild(t3);const mk=(k,w)=>{const t=ce("td");t.className=w;const i=ce("input");return i.type="text",i.value=r[k],i.onchange=e=>{r[k]=e.target.value,sch()},t.appendChild(i),t};x.appendChild(mk("C","col-c")),x.appendChild(mk("R","col-r")),x.appendChild(mk("Vs","col-vs")),x.appendChild(mk("V0","col-v0"));const tC=ce("td");tC.className="col-color";const sC=ce("select");Object.keys(CL).forEach(k=>{const o=ce("option");o.value=k,o.text=k,r.cl===k&&(o.selected=!0),sC.appendChild(o)}),sC.onchange=e=>{r.cl=e.target.value,sch()},tC.appendChild(sC),x.appendChild(tC),b.appendChild(x)})}function ar(a=!0,n="Caso",m="CARGA",c=1e-6,r=1e3,vs=5,v0=5,cl="Celeste"){RD.push({a:a,n:n,m:m,C:c.toString(),R:r.toString(),Vs:vs.toString(),V0:v0.toString(),cl:cl}),ren(),sch()}function rp(){const S=parseFloat(g("spinTmax").value),U=g("comboTimeUnit").value,Y=g("comboY").value,MT=g("chkMarkTau").checked,AR=g("chkAutorange").checked;let mx=S;"mS"===U&&(mx=S/1e3);const t=ls(0,mx,DP),tr=[],an=[],yl="Vc"===Y?"Vc (Volts)":"I"===Y?"I (Amper)":"Q (Coulombs)";let ac=!1;RD.forEach(r=>{if(!r.a)return;try{const c=cp(r.C,1e-6);let o=null;r.R&&""!==r.R.trim()&&(o=parseFloat(r.R.replace(",","."))),o<0&&(o=null);const v=parseFloat((r.Vs||"5").replace(",",".")),z=parseFloat((r.V0||"5").replace(",",".")),h=CL[r.cl]||CL.Celeste,ds=_M.c(t,r.m,c,o,v,z);let w=[];"Vc"===Y?w=ds.Vc:"I"===Y?(null!==ds.I[0]&&(w=ds.I)):w=ds.Q;tr.push({x:t,y:w,mode:"lines",name:`${r.n} [${r.m}]`,line:{color:h,width:2},hoverinfo:"name+x+y"}),ac=!0;if(MT&&null!==ds.tau&&ds.tau>0&&ds.tau<=mx){const dt=_M.c([ds.tau],r.m,c,o,v,z);let yt=0;"Vc"===Y?yt=dt.Vc[0]:"I"===Y?yt=dt.I[0]:yt=dt.Q[0];null!==yt&&(tr.push({x:[ds.tau],y:[yt],mode:"markers",showlegend:!1,marker:{size:8,color:"#12b886",line:{color:"#00bb55",width:1}},hoverinfo:"skip"}),an.push({x:ds.tau,y:yt,text:`τ=${fe(ds.tau)}s`,xanchor:"left",yanchor:"bottom",showarrow:!1,font:{color:"#1f1f1f",size:12}}))}}catch(e){}});const l={autosize:!0,margin:{t:30,r:20,b:40,l:60},xaxis:{title:"Tiempo (s)",showgrid:!0,zeroline:!0,gridcolor:"#d7d7d7"},yaxis:{title:yl,showgrid:!0,gridcolor:"#d7d7d7"},plot_bgcolor:"#fff",paper_bgcolor:"#fff",showlegend:!0,legend:{x:.01,y:.99},annotations:an};if(AR)l.xaxis.autorange=!0,l.yaxis.autorange=!0;else{const d=g("plotDiv");d&&d.layout&&d.layout.xaxis&&d.layout.xaxis.range&&(l.xaxis.range=d.layout.xaxis.range,l.yaxis.range=d.layout.yaxis.range)}ac||an.push({x:mx/2,y:0,text:"No hay curvas activas.",showarrow:!1,font:{size:16,color:"#1f1f1f"}}),Plotly.react("plotDiv",tr,l,{responsive:!0,displayModeBar:!1})}function exp(){const S=parseFloat(g("spinTmax").value),U=g("comboTimeUnit").value,Y=g("comboY").value;let mx=S;"mS"===U&&(mx=S/1e3);const t=ls(0,mx,DP);let csv="data:text/csv;charset=utf-8,";const h=["t_segundos"],c=[t];RD.forEach(r=>{if(!r.a)return;try{const f=cp(r.C,1e-6);let o=null;r.R&&""!==r.R.trim()&&(o=parseFloat(r.R.replace(",","."))),o<0&&(o=null);const v=parseFloat((r.Vs||"5").replace(",",".")),z=parseFloat((r.V0||"5").replace(",",".")),ds=_M.c(t,r.m,f,o,v,z);let w=null,sf="";"Vc"===Y?(w=ds.Vc,sf="Volts"):"I"===Y?(w=ds.I,sf="Amper"):(w=ds.Q,sf="Coulombs");if(w&&null!==w[0]){h.push(`${r.n.replace(/ /g,"_")}_${r.m}_${sf}`),c.push(w)}}catch(e){}});if(c.length<=1)return void alert("No hay curvas exportables.");csv+=h.join(";")+"\r\n";for(let i=0;i<DP;i++){let row=[];for(let k=0;k<c.length;k++)row.push(fe(c[k][i]));csv+=row.join(";")+"\r\n"}const ur=encodeURI(csv),lnk=ce("a");lnk.setAttribute("href",ur),lnk.setAttribute("download","curvas_rc.csv"),d.body.appendChild(lnk),lnk.click(),d.body.removeChild(lnk)}window.onload=()=>{ar(!0,"Carga","CARGA",1e-4,1e3,5,5,"Celeste"),ar(!0,"Descarga","DESCARGA",1e-4,1e3,5,5,"Verde");const sT=g("spinTmax");sT.onchange=sch,sT.oninput=sch;g("comboTimeUnit").onchange=e=>{ut(e.target.value),sch()};g("comboY").onchange=sch;g("chkMarkTau").onchange=sch;g("chkAutorange").onchange=sch;g("btnAdd").onclick=()=>ar();g("btnDel").onclick=()=>{SI>=0&&SI<RD.length?(RD.splice(SI,1),SI=-1):RD.length>0&&RD.pop(),ren(),sch()};g("btnPlt").onclick=rp;g("btnCsv").onclick=exp;Plotly.newPlot("plotDiv",[],{margin:{t:10,r:10,b:40,l:60},plot_bgcolor:"#fff",paper_bgcolor:"#fff",xaxis:{title:"Tiempo (s)",gridcolor:"#d7d7d7"},yaxis:{title:"Magnitud",gridcolor:"#d7d7d7"}},{responsive:!0,displayModeBar:!1});g("plotDiv").on("plotly_hover",d=>{if(d.points.length>0){let p=d.points[0];g("cursorLabel").textContent=`Tiempo: ${p.x.toPrecision(5)} s | Valor: ${p.y.toPrecision(5)}`}}),rp()}})()
</script></body></html>